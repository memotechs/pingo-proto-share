syntax = "proto3";

import "google/protobuf/timestamp.proto";

package schedule;

service ScheduleService {
  // Booking
  rpc CreateBooking (CreateBookingRequest) returns (CreateBookingResponse) {}
  rpc UpdateBooking (CreateBookingRequest) returns (CreateBookingResponse) {}
  rpc GetOneBookingByNo (GetOneBookingByNoRequest) returns (GetOneBookingResponse) {}
  rpc GetOneBookingById (GetOneBookingByNoRequest) returns (GetOneBookingResponse) {}
  rpc GetBookingListWithPagination (GetBookingListWithPaginationRequest) returns (GetBookingListWithPaginationResponse) {}
  rpc GetUserBookingListWithPagination (GetBookingListWithPaginationRequest) returns (GetBookingListWithPaginationResponse) {}

  // Schedules
  rpc GetScheduleListWithPagination (GetScheduleListWithPaginationRequest) returns (GetScheduleListWithPaginationResponse) {}
  rpc GetScheduleListDetail (GetScheduleListDetailRequest) returns (GetScheduleListDetailResponse) {}

  // Locations
  rpc GetLocationListWithPagination (GetLocationListWithPaginationRequest) returns (GetLocationListWithPaginationResponse) {}

  // Vehicle Types
  rpc GetVehicleTypeListAutocomplete (GetVehicleTypeListAutocompleteRequest) returns (GetVehicleTypeListAutocompleteResponse) {}

  // Service Types
  rpc GetServiceTypeListAutocomplete (GetServiceTypeListAutocompleteRequest) returns (GetServiceTypeListAutocompleteResponse) {}
}

message Schedule {
  google.protobuf.Timestamp arrivalAt = 1;
  google.protobuf.Timestamp departureAt = 2;
  int32 id = 3;
  bool isPublished = 4;
  Route route = 5;
  Vehicle vehicle = 6;
}

message ScheduleLine {
  string arrivalAt = 1;
  string departureAt = 2;
  string duration = 3;
  Location fromLocation = 4;
  int32 id = 5;
  bool isCrossdate = 6;
  bool openForReturn = 7;
  repeated Price prices = 8;
  Route route = 9;
  ServiceType serviceType = 10;
  Location toLocation = 11;
  Vehicle vehicle = 12;
  int32 availableSeats = 13;
  int32 totalSeats = 14;
}

message Location {
  int32 id = 1;
  string name = 2;
  string nameKh = 3;
  string shortName = 4;
}

message Merchant {
  int32 id = 1;
  string name = 2;
  string logoUrl = 3;
}

message Route {
  string id = 1;
  string name = 2;
  string shortName = 3;
}

message ServiceType {
  int32 id = 1;
  string icon = 2;
  string name = 3;
}

message Vehicle {
  int32 id = 4;
  string name = 2;
  string mediaUrl = 3;
}

message Media {
  int32 id = 1;
  int32 type = 2;
  bool isDefault = 3;
  string mediaUrl = 4;
}

message Price {
  int32 id = 1;
  double amount = 2;
  bool isDefault = 3;
  string name = 4;
  int32 order = 5;
}

message GetScheduleListWithPaginationRequest {
  int32 pageSize = 1;
  int32 page = 2;
  int32 fromLocation = 3;
  int32 toLocation = 4;
  string date = 5;
}
message GetScheduleListWithPaginationResponse {
  repeated ScheduleLine data = 1;
  int32 page = 2;
  int32 pageSize = 3;
  bool hasNext = 4;
}

message GetScheduleListDetailRequest {
  int32 id = 1;
  string date = 2;
  Merchant merchant = 3;
}
message GetScheduleListDetailResponse {
  int32 status = 1;
  string message = 2;
  ScheduleLine schedule = 3;
  Merchant merchant = 4;
  int32 fromLocationId = 5;
  int32 toLocationId = 6;
  string date = 7;
  int32 page = 8;
}

message GetScheduleDetailRequest {
  Merchant merchant = 1;
  string date = 2;
  int32 scheduleLineId = 3;
}

message GetScheduleDetailResponse {
  int32 current_page = 1;
  int32 total = 2;
  int32 per_page = 3;
  int32 items = 4;
  bool has_next = 5;
  repeated ScheduleLine scheduleLines = 6;
}

message Booking {
  int32 id = 1;
  string bookingNo = 2;
}

message BookingItem {
  int32 id = 1;
  double price = 2;
  Booking Booking = 3;
}

message GetBookingListWithPaginationRequest {}
message GetBookingListWithPaginationResponse {}

// Create Booking
message CreateBookingRequest {

}
message CreateBookingResponse {

}

// Update Booking
message UpdateBookingRequest {
  int32 id = 1;
}

message UpdateBookingResponse {
  int32 status = 1;
  Booking booking = 2;
  string message = 3;
}

// Get Booking By booking number
message GetOneBookingByNoRequest {
  string bookingNo = 1;
}
// Get Booking by Id
message GetOneBookingByIdRequest {
  int32 id = 1;
}
message GetOneBookingResponse {
  int32 status = 1;
  Booking booknig = 2;
  string message = 3;
}

// Locations
message GetLocationListWithPaginationRequest {
  int32 pageSize = 1;
  int32 page = 2;
  string query = 3;
}

message GetLocationListWithPaginationResponse {
  repeated Location data = 1;
  int32 page = 2;
  int32 pageSize = 3;
  bool hasNext = 4;
}

// Vehicle Types
message GetVehicleTypeListAutocompleteRequest {
  int32 pageSize = 1;
  int32 page = 2;
  string query = 3;
}

message GetVehicleTypeListAutocompleteResponse {
  repeated VehicleType data = 1;
  int32 page = 2;
  int32 pageSize = 3;
  bool hasNext = 4;
}

message VehicleType {
  string name = 1;
  string icon = 2;
  string description = 3;
  ServiceType serviceType = 4;
}

// Service Types
message GetServiceTypeListAutocompleteRequest {
  int32 pageSize = 1;
  int32 page = 2;
  string query = 3;
}

message GetServiceTypeListAutocompleteResponse {
  repeated ServiceType data = 1;
  int32 page = 2;
  int32 pageSize = 3;
  bool hasNext = 4;
}
